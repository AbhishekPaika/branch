This is the modified version of chapter 2